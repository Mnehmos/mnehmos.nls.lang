{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"NLS Compiler","text":"<p>The source code is English. The compiled artifact is Python.</p> <p>NLS is a programming language where specifications are written in plain English that anyone can read\u2014managers, auditors, domain experts\u2014not just programmers. The <code>nlsc</code> compiler translates <code>.nl</code> files into executable Python with full type hints, validation, and documentation.</p>"},{"location":"#why-nls","title":"Why NLS?","text":"<ul> <li>Readable by everyone \u2014 Non-programmers can review business logic</li> <li>Auditable \u2014 Clear mapping from intent to implementation</li> <li>Testable \u2014 Specifications include test cases</li> <li>Versionable \u2014 Lock files ensure reproducibility</li> <li>Toolable \u2014 Tree-sitter grammar enables IDE support</li> </ul>"},{"location":"#quick-example","title":"Quick Example","text":"<pre><code>@module calculator\n@target python\n\n[divide]\nPURPOSE: Divide two numbers safely\nINPUTS:\n  - numerator: number\n  - divisor: number\nGUARDS:\n  - divisor must not be zero -&gt; ValueError(\"Cannot divide by zero\")\nRETURNS: numerator / divisor\n</code></pre> <p>Compiles to:</p> <pre><code>def divide(numerator: float, divisor: float) -&gt; float:\n    \"\"\"Divide two numbers safely.\"\"\"\n    if divisor == 0:\n        raise ValueError(\"Cannot divide by zero\")\n    return numerator / divisor\n</code></pre>"},{"location":"#project-status","title":"Project Status","text":"Component Status Parser (regex) \u2705 Complete Parser (tree-sitter) \u2705 Complete Python emitter \u2705 Complete Type generation \u2705 Complete Guard validation \u2705 Complete Dataflow analysis \u2705 Complete Test runner \u2705 Complete Watch mode \u2705 Complete VS Code extension \ud83d\udd1c Planned TypeScript target \ud83d\udd1c Planned <p>160 tests passing \u2014 Production-ready for Python target.</p>"},{"location":"#get-started","title":"Get Started","text":"<ul> <li>:material-download: Installation</li> </ul> <p>Install nlsc with pip</p> <ul> <li>:material-console: CLI Reference</li> </ul> <p>All 8 commands documented</p> <ul> <li>:material-book-open: Language Spec</li> </ul> <p>Full syntax reference</p> <ul> <li>:material-cog: Architecture</li> </ul> <p>How the compiler works</p>"},{"location":"architecture/","title":"Architecture","text":"<p>This document describes the internal architecture of the NLS compiler.</p>"},{"location":"architecture/#pipeline-overview","title":"Pipeline Overview","text":"<pre><code>flowchart LR\n    A[\".nl file\"] --&gt; B[Parser]\n    B --&gt; C[AST]\n    C --&gt; D[Resolver]\n    D --&gt; E[Emitter]\n    E --&gt; F[\".py file\"]\n    E --&gt; G[\".nl.lock\"]</code></pre> <p>The compiler follows a classic pipeline architecture:</p> <ol> <li>Parser \u2014 Converts <code>.nl</code> text to AST</li> <li>Resolver \u2014 Validates dependencies and ordering</li> <li>Emitter \u2014 Generates Python code</li> <li>Lockfile \u2014 Records hashes for reproducibility</li> </ol>"},{"location":"architecture/#module-breakdown","title":"Module Breakdown","text":""},{"location":"architecture/#core-modules","title":"Core Modules","text":"Module Purpose Lines <code>parser.py</code> Regex-based parser ~500 <code>parser_treesitter.py</code> Tree-sitter parser ~600 <code>resolver.py</code> Dependency resolution ~100 <code>emitter.py</code> Python code generation ~400 <code>lockfile.py</code> Hash computation and storage ~200 <code>schema.py</code> AST data structures ~300"},{"location":"architecture/#cli-modules","title":"CLI Modules","text":"Module Purpose <code>cli.py</code> Command-line interface <code>graph.py</code> Visualization (Mermaid, DOT, ASCII) <code>diff.py</code> Change detection <code>watch.py</code> File watcher <code>atomize.py</code> Python \u2192 NL extraction"},{"location":"architecture/#parser-backends","title":"Parser Backends","text":""},{"location":"architecture/#regex-parser-default","title":"Regex Parser (Default)","text":"<p>The regex parser uses pattern matching to tokenize and parse <code>.nl</code> files.</p> <pre><code># Pattern examples from parser.py\nANLU_START = r\"^\\[([a-z][a-z0-9.-]*)\\]\\s*$\"\nDIRECTIVE = r\"^@(module|version|target|imports)\"\nSECTION = r\"^(PURPOSE|INPUTS|GUARDS|LOGIC|RETURNS|DEPENDS|EDGE CASES):\"\n</code></pre> <p>Pros:</p> <ul> <li>Zero dependencies</li> <li>Fast for simple files</li> <li>Easy to understand</li> </ul> <p>Cons:</p> <ul> <li>Limited error recovery</li> <li>Complex patterns for edge cases</li> </ul>"},{"location":"architecture/#tree-sitter-parser","title":"Tree-sitter Parser","text":"<p>The tree-sitter parser uses a formal grammar for parsing.</p> <pre><code># Install tree-sitter support\npip install nlsc[treesitter]\n\n# Use tree-sitter parser\nnlsc --parser treesitter compile src/auth.nl\n</code></pre> <p>Pros:</p> <ul> <li>Better error recovery</li> <li>Incremental parsing</li> <li>Foundation for LSP/IDE support</li> </ul> <p>Cons:</p> <ul> <li>Requires native dependency</li> <li>Slightly more complex setup</li> </ul>"},{"location":"architecture/#ast-schema","title":"AST Schema","text":"<p>The AST is defined in <code>schema.py</code>:</p> <pre><code>@dataclass\nclass NLFile:\n    module: ModuleDirective\n    version: str | None\n    target: str\n    imports: list[str]\n    anlus: list[ANLU]\n    types: list[TypeDef]\n    tests: list[TestSpec]\n    literals: list[LiteralBlock]\n\n@dataclass\nclass ANLU:\n    identifier: str\n    purpose: str\n    inputs: list[InputDef]\n    guards: list[Guard]\n    logic: list[LogicStep]\n    returns: str\n    depends: list[str]\n    edge_cases: list[EdgeCase]\n</code></pre>"},{"location":"architecture/#resolution","title":"Resolution","text":"<p>The resolver validates:</p> <ol> <li>Dependency existence \u2014 All <code>DEPENDS</code> references exist</li> <li>Cycle detection \u2014 No circular dependencies</li> <li>Ordering \u2014 Topological sort for code generation</li> </ol> <pre><code>result = resolve_dependencies(nl_file)\nif not result.success:\n    for error in result.errors:\n        print(f\"{error.anlu_id}: {error.message}\")\n</code></pre>"},{"location":"architecture/#code-emission","title":"Code Emission","text":"<p>The emitter transforms AST to Python:</p>"},{"location":"architecture/#anlu-function","title":"ANLU \u2192 Function","text":"<pre><code>[add]\nPURPOSE: Add two numbers\nINPUTS:\n  - a: number\n  - b: number\nRETURNS: a + b\n</code></pre> <p>Becomes:</p> <pre><code>def add(a: float, b: float) -&gt; float:\n    \"\"\"Add two numbers.\"\"\"\n    return a + b\n</code></pre>"},{"location":"architecture/#type-dataclass","title":"@type \u2192 Dataclass","text":"<pre><code>@type Point {\n  x: number\n  y: number\n}\n</code></pre> <p>Becomes:</p> <pre><code>@dataclass\nclass Point:\n    \"\"\"Point type.\"\"\"\n    x: float\n    y: float\n</code></pre>"},{"location":"architecture/#guards-validation","title":"GUARDS \u2192 Validation","text":"<pre><code>GUARDS:\n  - divisor must not be zero -&gt; ValueError(\"Cannot divide by zero\")\n</code></pre> <p>Becomes:</p> <pre><code>if divisor == 0:\n    raise ValueError(\"Cannot divide by zero\")\n</code></pre>"},{"location":"architecture/#lockfile","title":"Lockfile","text":"<p>Lockfiles ensure reproducible builds:</p> <pre><code># example.nl.lock\nversion: \"1.0\"\nsource_hash: \"a1b2c3...\"\ntarget_hash: \"d4e5f6...\"\nanlus:\n  add:\n    hash: \"abc123...\"\n    inputs: [\"a: number\", \"b: number\"]\n    returns: \"a + b\"\n  multiply:\n    hash: \"def456...\"\n    inputs: [\"a: number\", \"b: number\"]\n    returns: \"a \u00d7 b\"\nllm_backend: \"mock\"\ncompiled_at: \"2024-01-15T10:30:00Z\"\n</code></pre> <p>The lockfile enables:</p> <ul> <li>Change detection (<code>nlsc diff</code>)</li> <li>Reproducible builds</li> <li>Audit trails</li> </ul>"},{"location":"architecture/#extension-points","title":"Extension Points","text":""},{"location":"architecture/#adding-a-new-target","title":"Adding a New Target","text":"<ol> <li>Create <code>emitter_&lt;target&gt;.py</code></li> <li>Implement <code>emit_&lt;target&gt;(nl_file: NLFile) -&gt; str</code></li> <li>Register in <code>cli.py</code> compile command</li> </ol>"},{"location":"architecture/#adding-a-new-parser-feature","title":"Adding a New Parser Feature","text":"<ol> <li>Update grammar in <code>tree-sitter-nl/grammar.js</code></li> <li>Regenerate with <code>npx tree-sitter generate</code></li> <li>Update <code>parser_treesitter.py</code> to handle new nodes</li> <li>Update <code>parser.py</code> with matching regex patterns</li> </ol>"},{"location":"architecture/#adding-a-new-cli-command","title":"Adding a New CLI Command","text":"<ol> <li>Create <code>cmd_&lt;name&gt;</code> function in <code>cli.py</code></li> <li>Add subparser in <code>main()</code></li> <li>Add case in command dispatch</li> </ol>"},{"location":"architecture/#testing","title":"Testing","text":"<pre><code># Run all tests\npytest tests/ -v\n\n# Run specific test module\npytest tests/test_emitter.py -v\n\n# Run tree-sitter grammar tests\ncd tree-sitter-nl &amp;&amp; npx tree-sitter test\n</code></pre> <p>Test coverage includes:</p> <ul> <li>12 regex parser tests</li> <li>25 tree-sitter grammar tests</li> <li>9 parser parity tests</li> <li>15+ emitter tests</li> <li>Dataflow, guards, types, roundtrip tests</li> </ul> <p>Total: 160 tests passing</p>"},{"location":"cli-reference/","title":"CLI Reference","text":"<p>The <code>nlsc</code> command-line interface provides 8 commands for working with NLS files.</p>"},{"location":"cli-reference/#global-options","title":"Global Options","text":"<pre><code>nlsc [--parser {regex,treesitter}] [--version] [--help] &lt;command&gt;\n</code></pre> Option Description <code>--parser</code> Parser backend: <code>regex</code> (default) or <code>treesitter</code> <code>--version</code> Show version number <code>--help</code> Show help message"},{"location":"cli-reference/#commands","title":"Commands","text":""},{"location":"cli-reference/#nlsc-init","title":"<code>nlsc init</code>","text":"<p>Initialize a new NLS project with standard folder structure.</p> <pre><code>nlsc init [path]\n</code></pre> Argument Description <code>path</code> Project directory (default: current directory) <p>Example:</p> <pre><code>nlsc init my-project\n</code></pre> <p>Creates:</p> <pre><code>my-project/\n\u251c\u2500\u2500 nl.config.yaml    # Project configuration\n\u251c\u2500\u2500 src/              # Source .nl files\n\u2502   \u2514\u2500\u2500 __init__.py\n\u2514\u2500\u2500 tests/            # Generated tests\n    \u2514\u2500\u2500 __init__.py\n</code></pre>"},{"location":"cli-reference/#nlsc-compile","title":"<code>nlsc compile</code>","text":"<p>Compile a <code>.nl</code> file to the target language (currently Python).</p> <pre><code>nlsc compile &lt;file&gt; [-t TARGET] [-o OUTPUT]\n</code></pre> Option Description <code>file</code> Path to <code>.nl</code> file <code>-t, --target</code> Target language (default: <code>python</code>) <code>-o, --output</code> Output file path <p>Examples:</p> <pre><code># Basic compile\nnlsc compile src/auth.nl\n\n# Compile with tree-sitter parser\nnlsc --parser treesitter compile src/auth.nl\n\n# Specify output file\nnlsc compile src/auth.nl -o lib/auth.py\n</code></pre> <p>Generated files:</p> <ul> <li><code>&lt;name&gt;.py</code> \u2014 Python module</li> <li><code>test_&lt;name&gt;.py</code> \u2014 Test file (if <code>@test</code> blocks present)</li> <li><code>&lt;name&gt;.nl.lock</code> \u2014 Lockfile for reproducibility</li> </ul>"},{"location":"cli-reference/#nlsc-verify","title":"<code>nlsc verify</code>","text":"<p>Validate a <code>.nl</code> file without generating code. Checks syntax and dependencies.</p> <pre><code>nlsc verify &lt;file&gt;\n</code></pre> <p>Example:</p> <pre><code>nlsc verify src/order.nl\n</code></pre> <p>Output:</p> <pre><code>Verifying src/order.nl (parser: regex)...\n  \u2713 Syntax valid: 5 ANLUs\n  \u2713 Dependencies valid\n  \u2713 All ANLUs valid\n\nVerification passed!\n</code></pre>"},{"location":"cli-reference/#nlsc-test","title":"<code>nlsc test</code>","text":"<p>Run <code>@test</code> specifications from a <code>.nl</code> file.</p> <pre><code>nlsc test &lt;file&gt; [-v]\n</code></pre> Option Description <code>file</code> Path to <code>.nl</code> file <code>-v, --verbose</code> Verbose output <p>Example:</p> <pre><code>nlsc test src/math.nl -v\n</code></pre> <p>The command:</p> <ol> <li>Compiles the <code>.nl</code> file to a temp directory</li> <li>Generates test code from <code>@test</code> blocks</li> <li>Runs pytest on the generated tests</li> </ol>"},{"location":"cli-reference/#nlsc-graph","title":"<code>nlsc graph</code>","text":"<p>Generate dependency and dataflow visualizations.</p> <pre><code>nlsc graph &lt;file&gt; [-f FORMAT] [-a ANLU] [--dataflow] [-o OUTPUT]\n</code></pre> Option Description <code>file</code> Path to <code>.nl</code> file <code>-f, --format</code> Output format: <code>mermaid</code> (default), <code>dot</code>, <code>ascii</code> <code>-a, --anlu</code> Specific ANLU for dataflow visualization <code>--dataflow</code> Show dataflow instead of FSM states <code>-o, --output</code> Output file path (default: stdout) <p>Examples:</p> <pre><code># Module dependency graph\nnlsc graph src/order.nl --format mermaid\n\n# Dataflow for specific ANLU\nnlsc graph src/order.nl --anlu process-order --dataflow\n\n# Export as DOT for Graphviz\nnlsc graph src/order.nl --format dot -o deps.dot\n</code></pre>"},{"location":"cli-reference/#nlsc-diff","title":"<code>nlsc diff</code>","text":"<p>Show changes since last compile by comparing against the lockfile.</p> <pre><code>nlsc diff &lt;file&gt; [--stat] [--full]\n</code></pre> Option Description <code>file</code> Path to <code>.nl</code> file <code>--stat</code> Show summary only <code>--full</code> Show full unified diff <p>Examples:</p> <pre><code># Show changed ANLUs\nnlsc diff src/api.nl\n\n# Summary statistics\nnlsc diff src/api.nl --stat\n\n# Full unified diff\nnlsc diff src/api.nl --full\n</code></pre>"},{"location":"cli-reference/#nlsc-watch","title":"<code>nlsc watch</code>","text":"<p>Watch a directory for <code>.nl</code> file changes and automatically recompile.</p> <pre><code>nlsc watch [dir] [-q] [-t] [-d DEBOUNCE]\n</code></pre> Option Description <code>dir</code> Directory to watch (default: current) <code>-q, --quiet</code> Suppress success messages <code>-t, --test</code> Run tests after successful compile <code>-d, --debounce</code> Debounce interval in ms (default: 100) <p>Examples:</p> <pre><code># Watch current directory\nnlsc watch\n\n# Watch with tests\nnlsc watch src/ --test\n\n# Quiet mode with custom debounce\nnlsc watch src/ -q -d 500\n</code></pre> <p>Press <code>Ctrl+C</code> to stop watching.</p>"},{"location":"cli-reference/#nlsc-atomize","title":"<code>nlsc atomize</code>","text":"<p>Extract ANLUs from existing Python source code (reverse compilation).</p> <pre><code>nlsc atomize &lt;file&gt; [-o OUTPUT] [-m MODULE]\n</code></pre> Option Description <code>file</code> Path to Python file <code>-o, --output</code> Output <code>.nl</code> file path <code>-m, --module</code> Module name for generated <code>.nl</code> <p>Example:</p> <pre><code>nlsc atomize legacy/utils.py -o src/utils.nl -m utils\n</code></pre> <p>This extracts functions from Python and generates corresponding ANLU blocks.</p>"},{"location":"cli-reference/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 Error (parse error, validation failure, etc.)"},{"location":"cli-reference/#environment-variables","title":"Environment Variables","text":"Variable Description <code>NLSC_PARSER</code> Default parser backend (<code>regex</code> or <code>treesitter</code>)"},{"location":"cli-reference/#configuration","title":"Configuration","text":"<p>Project settings are stored in <code>nl.config.yaml</code>:</p> <pre><code>project:\n  name: my-project\n  version: 0.1.0\n\ncompiler:\n  default_target: python\n  llm_backend: mock\n  cache_strategy: aggressive\n\ntargets:\n  python:\n    version: \"&gt;=3.11\"\n    style: black\n    type_hints: strict\n\nvalidation:\n  require_purpose: true\n  require_guards: false\n  max_anlu_complexity: 10\n</code></pre>"},{"location":"getting-started/","title":"Getting Started","text":"<p>This guide will walk you through installing NLS and creating your first compiled specification.</p>"},{"location":"getting-started/#installation","title":"Installation","text":"Basic InstallWith Tree-sitter ParserDevelopment Setup <pre><code>pip install -e .\n</code></pre> <pre><code>pip install -e \".[treesitter]\"\n</code></pre> <p>The tree-sitter parser provides faster parsing and better error recovery.</p> <pre><code>git clone https://github.com/Mnehmos/mnehmos.nls.lang.git\ncd mnehmos.nls.lang\npip install -e \".[dev,treesitter]\"\n</code></pre>"},{"location":"getting-started/#initialize-a-project","title":"Initialize a Project","text":"<p>Create a new NLS project with the proper folder structure:</p> <pre><code>nlsc init my-project\ncd my-project\n</code></pre> <p>This creates:</p> <pre><code>my-project/\n\u251c\u2500\u2500 nl.config.yaml    # Project configuration\n\u251c\u2500\u2500 src/              # Source .nl files\n\u2502   \u2514\u2500\u2500 __init__.py\n\u2514\u2500\u2500 tests/            # Generated tests\n    \u2514\u2500\u2500 __init__.py\n</code></pre>"},{"location":"getting-started/#your-first-nl-file","title":"Your First .nl File","text":"<p>Create <code>src/calculator.nl</code>:</p> <pre><code>@module calculator\n@target python\n\n[add]\nPURPOSE: Add two numbers together\nINPUTS:\n  - a: number\n  - b: number\nRETURNS: a + b\n\n[divide]\nPURPOSE: Divide two numbers safely\nINPUTS:\n  - numerator: number\n  - divisor: number\nGUARDS:\n  - divisor must not be zero -&gt; ValueError(\"Cannot divide by zero\")\nRETURNS: numerator / divisor\n\n@test [add] {\n  add(2, 3) == 5\n  add(-1, 1) == 0\n}\n</code></pre>"},{"location":"getting-started/#compile-to-python","title":"Compile to Python","text":"<pre><code>nlsc compile src/calculator.nl\n</code></pre> <p>Output:</p> <pre><code>Compiling src/calculator.nl (parser: regex)...\n  \u2713 Parsed 2 ANLUs\n  \u2713 Resolved dependencies\n  \u2713 Generated calculator.py (25 lines)\n  \u2713 Generated test_calculator.py\n  \u2713 Updated calculator.nl.lock\n\nCompilation complete!\n</code></pre>"},{"location":"getting-started/#run-the-tests","title":"Run the Tests","text":"<pre><code>nlsc test src/calculator.nl\n</code></pre> <p>Output:</p> <pre><code>Running 2 test cases from src/calculator.nl...\n  \u2022 [add]: 2 cases\n\n\u2713 All 2 tests passed!\n</code></pre>"},{"location":"getting-started/#use-the-generated-code","title":"Use the Generated Code","text":"<pre><code>from src.calculator import add, divide\n\nresult = add(2, 3)  # 5\nratio = divide(10, 2)  # 5.0\n\ntry:\n    divide(1, 0)\nexcept ValueError as e:\n    print(e)  # \"Cannot divide by zero\"\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>CLI Reference \u2014 Learn all 8 nlsc commands</li> <li>Language Specification \u2014 Full syntax reference</li> <li>Architecture \u2014 How the compiler works</li> </ul>"},{"location":"getting-started/#workflow-tips","title":"Workflow Tips","text":""},{"location":"getting-started/#watch-mode","title":"Watch Mode","text":"<p>Automatically recompile on file changes:</p> <pre><code>nlsc watch src/ --test\n</code></pre>"},{"location":"getting-started/#visualize-dependencies","title":"Visualize Dependencies","text":"<p>Generate Mermaid diagrams:</p> <pre><code>nlsc graph src/calculator.nl --format mermaid\n</code></pre>"},{"location":"getting-started/#see-what-changed","title":"See What Changed","text":"<p>View differences since last compile:</p> <pre><code>nlsc diff src/calculator.nl\n</code></pre>"},{"location":"language-spec/","title":"Language Specification","text":"<p>This document defines the complete syntax of <code>.nl</code> files.</p>"},{"location":"language-spec/#file-structure","title":"File Structure","text":"<p>An <code>.nl</code> file consists of:</p> <ol> <li>Directives \u2014 Module metadata (<code>@module</code>, <code>@version</code>, <code>@target</code>, <code>@imports</code>)</li> <li>ANLU Blocks \u2014 Function specifications (<code>[name]</code>)</li> <li>Type Definitions \u2014 Custom types (<code>@type</code>)</li> <li>Test Blocks \u2014 Test specifications (<code>@test</code>)</li> <li>Literal Blocks \u2014 Code escape hatches (<code>@literal</code>)</li> <li>Comments \u2014 Lines starting with <code>#</code></li> </ol>"},{"location":"language-spec/#directives","title":"Directives","text":""},{"location":"language-spec/#module","title":"<code>@module</code>","text":"<p>Required. Declares the module name.</p> <pre><code>@module calculator\n</code></pre> <p>Pattern: <code>^[a-z][a-z0-9_]*$</code> (lowercase snake_case)</p>"},{"location":"language-spec/#version","title":"<code>@version</code>","text":"<p>Optional semantic version.</p> <pre><code>@version 1.0.0\n</code></pre>"},{"location":"language-spec/#target","title":"<code>@target</code>","text":"<p>Required. Specifies the compilation target.</p> <pre><code>@target python\n</code></pre> <p>Supported: <code>python</code> (more coming)</p>"},{"location":"language-spec/#imports","title":"<code>@imports</code>","text":"<p>Optional comma-separated import list.</p> <pre><code>@imports jwt, datetime, typing\n</code></pre>"},{"location":"language-spec/#anlu-blocks","title":"ANLU Blocks","text":"<p>ANLU (Atomic Natural Language Unit) blocks define functions.</p> <pre><code>[function-name]\nPURPOSE: Single sentence describing what this does\nINPUTS:\n  - param1: type\n  - param2: type, optional\nGUARDS:\n  - condition -&gt; ErrorType(\"message\")\nLOGIC:\n  1. Description of step -&gt; variable\n  2. Another step\nEDGE CASES:\n  - condition -&gt; behavior\nRETURNS: expression\nDEPENDS: [other-function], [another]\n</code></pre>"},{"location":"language-spec/#identifier","title":"Identifier","text":"<p>ANLU names use kebab-case:</p> <pre><code>[calculate-tax]\n[is-empty]\n[validate-user-token]\n</code></pre> <p>Pattern: <code>^[a-z][a-z0-9-]*$</code></p> <p>For methods, use dot notation:</p> <pre><code>[User.validate]\n[Order.calculate-total]\n</code></pre>"},{"location":"language-spec/#purpose","title":"PURPOSE","text":"<p>Required. Single sentence in imperative mood.</p> <pre><code>PURPOSE: Calculate the total price including tax\n</code></pre>"},{"location":"language-spec/#inputs","title":"INPUTS","text":"<p>Typed parameter list with optional constraints.</p> <pre><code>INPUTS:\n  - amount: number\n  - rate: number, \"Tax rate as decimal\"\n  - currency: string, optional\n</code></pre> <p>Bullets can be <code>\u2022</code>, <code>-</code>, or <code>*</code>.</p>"},{"location":"language-spec/#guards","title":"GUARDS","text":"<p>Preconditions with error mappings.</p> <pre><code>GUARDS:\n  - amount must be non-negative -&gt; ValueError(\"Amount cannot be negative\")\n  - rate must be between 0 and 1 -&gt; ValidationError(INVALID_RATE, \"Rate must be 0-1\")\n</code></pre>"},{"location":"language-spec/#logic","title":"LOGIC","text":"<p>Numbered steps describing the algorithm.</p> <pre><code>LOGIC:\n  1. Calculate base tax -&gt; tax\n  2. Add service fee if applicable -&gt; fee\n  3. Combine tax and fee -&gt; total\n</code></pre> <p>Steps can include:</p> <ul> <li>Output binding: <code>-&gt; variable</code></li> <li>Conditionals: <code>IF condition THEN action</code></li> <li>State markers: <code>[state] action</code></li> </ul>"},{"location":"language-spec/#edge-cases","title":"EDGE CASES","text":"<p>Explicit boundary condition handling.</p> <pre><code>EDGE CASES:\n  - Zero amount -&gt; return 0\n  - Empty list -&gt; return None\n</code></pre>"},{"location":"language-spec/#returns","title":"RETURNS","text":"<p>Required. Output expression or type.</p> <pre><code>RETURNS: base + tax\nRETURNS: TaxResult with amount, effective_rate\nRETURNS: list of Order\n</code></pre>"},{"location":"language-spec/#depends","title":"DEPENDS","text":"<p>Dependencies on other ANLUs.</p> <pre><code>DEPENDS: [validate-input], [calculate-base]\n</code></pre>"},{"location":"language-spec/#type-system","title":"Type System","text":""},{"location":"language-spec/#primitives","title":"Primitives","text":"Type Description <code>number</code> Integer or float <code>string</code> Text <code>boolean</code> <code>true</code> / <code>false</code> <code>void</code> No return value <code>any</code> Dynamic typing escape hatch"},{"location":"language-spec/#composites","title":"Composites","text":"<p>List:</p> <pre><code>list of number\nlist of User\n</code></pre> <p>Optional:</p> <pre><code>string?\nUser?\n</code></pre> <p>Map:</p> <pre><code>map of string to number\n</code></pre> <p>Union:</p> <pre><code>string | number\nSuccess | Error\n</code></pre>"},{"location":"language-spec/#type-definitions","title":"Type Definitions","text":"<p>Define custom types with <code>@type</code>:</p> <pre><code>@type Point {\n  x: number\n  y: number\n}\n\n@type Order {\n  id: string, required\n  items: list of OrderItem\n  total: number, \"Order total in cents\"\n  status: string\n}\n</code></pre>"},{"location":"language-spec/#inheritance","title":"Inheritance","text":"<pre><code>@type OrderItem extends BaseItem {\n  quantity: number\n  price: number\n}\n</code></pre>"},{"location":"language-spec/#field-constraints","title":"Field Constraints","text":"<pre><code>@type User {\n  email: string, required\n  age: number, optional\n  role: string, \"User role in system\"\n}\n</code></pre>"},{"location":"language-spec/#test-blocks","title":"Test Blocks","text":"<p>Define test cases with <code>@test</code>:</p> <pre><code>@test [add] {\n  add(1, 2) == 3\n  add(0, 0) == 0\n  add(-5, 5) == 0\n}\n\n@test [divide] {\n  divide(10, 2) == 5.0\n  divide(9, 3) == 3.0\n}\n</code></pre> <p>Test blocks generate executable pytest code.</p>"},{"location":"language-spec/#literal-blocks","title":"Literal Blocks","text":"<p>Escape hatch for exact code when needed:</p> <pre><code>[slugify]\nPURPOSE: Convert text to URL-friendly slug format\nINPUTS:\n  - text: string\n\n@literal python {\nimport re\n\ndef slugify(text: str) -&gt; str:\n    \"\"\"Convert text to URL-friendly slug format.\"\"\"\n    text = text.lower().strip()\n    text = re.sub(r'\\s+', '-', text)\n    text = re.sub(r'[^a-z0-9-]', '', text)\n    return text.strip('-')\n}\n</code></pre> <p>Literal blocks bypass the compiler and emit code exactly as written.</p>"},{"location":"language-spec/#comments","title":"Comments","text":"<p>Lines starting with <code>#</code> are comments:</p> <pre><code># Math Module\n# This provides basic arithmetic operations\n\n@module math\n@target python\n\n# Addition function\n[add]\nPURPOSE: Add two numbers\n...\n</code></pre>"},{"location":"language-spec/#formatting-notes","title":"Formatting Notes","text":"<ol> <li>Bullets are flexible: <code>\u2022</code>, <code>-</code>, or <code>*</code></li> <li>Arrows are flexible: <code>\u2192</code> (Unicode) or <code>-&gt;</code> (ASCII)</li> <li>Section headers are case-insensitive</li> <li>Indentation uses spaces for visual structure</li> <li>Unicode is supported in text content</li> </ol>"},{"location":"language-spec/#grammar-reference","title":"Grammar Reference","text":"<p>For the complete formal grammar, see nl-grammar.ebnf.</p>"}]}